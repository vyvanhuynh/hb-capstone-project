{% extends 'base.html' %}
{% block title %}Pet Care Discussion Forum{% endblock %}


{% block body %}
    <div class="row">
    <h1>Pet Care Discussion Forum</h1>
    </div>

    <div class="row">

    <div class="col-9 col-md-6">

    <!-- Search bar (not functional yet)-->

        <div>
          <form action="/forum" method="POST">
            <input type="text" name="key_word">
            <input type="submit" name="new search">
          </form>
        </div>
  

    <!-- Display only matched Question and Answer contents according to search result-->
    <h3>Matched Results</h3>
    <ol>
        {% for matched_question in matched_questions|sort(attribute='vote_count', reverse = True) %}
            <li>
                <form action="/forum" method="POST">
                <input type="hidden" id="question_id" name="question_id" value={{matched_question.question_id}}>
                <p>{{ matched_question.question_body }}
                    <input type="submit" name="new vote" value="Vote" >
                    Vote number: {{ matched_question.vote_count }}
                </p>
    
                <ul>
                    {% for answer in matched_question.answers %}
                        <li>{{ answer.answer_body }}</li>
                    {% endfor %}
                        <p>
                            Your answer <input type="text" name="new_answer">
                        </p>
                        <p>
                            <input type="submit" name="new answer">
                        </p>
                </ul>
                </form>
            </li>
        {% endfor %}
    </ol>
        

    <!-- Display all Question and Answer contents-->
    <h2>All Questions and Answers</h2> 
    <ol>
    {% for question in questions|sort(attribute='vote_count', reverse = True) %}
        <li>
            <form action="/forum" method="POST">
            <input type="hidden" id="question_id" name="question_id" value={{question.question_id}}>
            <p>{{ question.question_body }}
                <input type="submit" name="new vote" value="Vote" >
                Vote number: {{ question.vote_count }}
            </p>

            <ul>
                {% for answer in question.answers %}
                    <li>{{ answer.answer_body }}</li>
                {% endfor %}
                    <p>
                        Your answer <input type="text" name="new_answer">
                    </p>
                    <p>
                        <input type="submit" name="new answer">
                    </p>
            </ul>
            </form>
        </li>
    {% endfor %}
    </ol> 
    </div>

    <!-- Let users input question -->
    <div class="col-3 col-md-6">
        <h3>Ask A Question</h3>
        <form action="/forum" method="POST">
            <p>
                Your question 
            </p>
            <textarea type="text" name="new_question" id="new_question"></textarea>
            <p>
                <input type="submit" name="new question">
            </p>
        </form>
        <!-- the link to lookup nearby vets -->
        <h4>
            Do you need to look up a vet nearby?
            <a href="/map">Look up nearby vet</a>
        </h4>
    </div>

    </div>
 
    
{% endblock %}

    
